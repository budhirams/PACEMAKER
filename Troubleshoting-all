âœ… Correct Configuration Example
Check with:
pcs resource show VirtualIP


Agar output me galat format hoga to error aayega.

Correct format should be:
pcs resource create VirtualIP IPaddr2 \
    ip=10.191.145.144 \
    cidr_netmask=21 \
    nic=ens192 \
    op monitor interval=20s

ðŸ”¥ WHY ERROR APPEARS?
1. NIC name wrong?

Check:

ip a


NIC ka sahi naam ho:

ens192

eth0

ens160

Agar cluster me NIC name same nahi hai to bhi findif fail karega.

2. Wrong netmask format?

IPaddr2 CIDR format mangta hai:

âœ” cidr_netmask=21
âŒ netmask=255.255.248.0 (Old format)

â­ Fix Step-by-Step
1. Delete wrong resource
pcs resource delete VirtualIP

2. Re-create with correct syntax
pcs resource create VirtualIP IPaddr2 \
    ip=10.191.145.144 \
    cidr_netmask=21 \
    nic=ens192 \
    op monitor interval=20s

3. Clear failure
pcs resource cleanup VirtualIP
pcs resource refresh VirtualIP

4. Check status
pcs status




pcs resource config VirtualIP
pcs status





Correct format ALWAYS à¤‡à¤¸ à¤¤à¤°à¤¹ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤:
pcs resource create VirtualIP ocf:heartbeat:IPaddr2 ip=10.191.145.144 \
 cidr_netmask=21 \
 nic=ens192 \
 op monitor interval=30s




pcs resource delete VirtualIP
pcs resource cleanup



pcs resource create VirtualIP IPaddr2 \
 ip=10.191.145.144 \
 cidr_netmask=21 \
 nic=ens192 \
 op monitor interval=30s



pcs status --full





âœ… Correct (Healthy) Output kaise dikhna chahiye?
Healthy Cluster:
Full List of Resources:
  * vmfence     (stonith:fence_vmware_rest):     Started cmpcprmq90
  * VirtualIP   (ocf:heartbeat:IPaddr2):         Started cmpcprmq90


Agar failover ho jaye to:

Full List of Resources:
  * vmfence     (stonith:fence_vmware_rest):     Started cmpcprmq94
  * VirtualIP   (ocf:heartbeat:IPaddr2):         Started cmpcprmq94






âœ… Next Step (Fix)

ðŸ‘‰ Mujhe yeh output bhej do:

pcs stonith show vmfence
pcs stonith config



âœ” Check which version of resource agent is installed

Run this:

rpm -qa | grep resource-agents


Old versions do not support CIDR.

But again â†’ aapke logs ne already confirm kar diya.




rpm -qa | grep resource-agents
Expected Output Example
Copy code
resource-agents-4.12.0-4.el9.x86_64
resource-agents-sap-4.12.0-4.el9.x86_64
à¤…à¤—à¤° à¤à¤¸à¤¾ à¤•à¥‹à¤ˆ à¤ªà¥ˆà¤•à¥‡à¤œ à¤¦à¤¿à¤–à¤¤à¤¾ à¤¹à¥ˆ â†’ à¤¤à¥‹ à¤†à¤ªà¤•à¥‡ à¤¸à¤¿à¤¸à¥à¤Ÿà¤® à¤®à¥‡à¤‚
IPaddr2 agent already installed à¤¹à¥ˆà¥¤


âœ… Step-2: Check if IPaddr2 available in OCF path

Check:

ls /usr/lib/ocf/resource.d/heartbeat/ | grep IPaddr2

Expected Output:
IPaddr2

à¤‡à¤¸à¤•à¤¾ à¤®à¤¤à¤²à¤¬ à¤¹à¥ˆ IPaddr2 agent à¤¸à¤¹à¥€ à¤œà¤—à¤¹ à¤®à¥Œà¤œà¥‚à¤¦ à¤¹à¥ˆ à¤”à¤° à¤†à¤ª à¤‡à¤¸à¥‡ PCS à¤®à¥‡à¤‚ use à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹à¥¤

âœ… Step-3: Why cidr_netmask=21 and NOT netmask=255.255.248.0?

RHEL 9 / Pacemaker à¤®à¥‡à¤‚ à¤¨à¤¯à¤¾ format use à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ:

âœ” Modern format
cidr_netmask=21

âœ” Equivalent old format
netmask=255.255.248.0


à¤¦à¥‹à¤¨à¥‹à¤‚ SAME à¤¹à¥ˆà¤‚à¥¤





rpm -qa | grep resource-agents
Expected Output:
à¤•à¥à¤› à¤à¤¸à¤¾ à¤¦à¤¿à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤:

Copy code
resource-agents-4.12.0-4.el9.x86_64
à¤¯à¤¹ à¤¦à¤¿à¤–à¤¾à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ resource-agents à¤ªà¥ˆà¤•à¥‡à¤œ à¤‡à¤‚à¤¸à¥à¤Ÿà¥‰à¤² à¤¹à¥ˆ à¤œà¤¿à¤¸à¤®à¥‡à¤‚ IPaddr2 resource agent à¤¹à¥ˆà¥¤

2. IPaddr2 agent à¤«à¤¼à¤¾à¤‡à¤² à¤œà¤¾à¤à¤šà¥‡à¤‚
bash
Copy code
ls /usr/lib/ocf/resource.d/heartbeat/ | grep IPaddr2
Expected output:

nginx
Copy code
IPaddr2
à¤®à¤¤à¤²à¤¬:
resource-agents à¤ªà¥ˆà¤•à¥‡à¤œ à¤•à¥‡ à¤¬à¤¿à¤¨à¤¾ à¤†à¤ªà¤•à¥‹ IPaddr2 resource agent à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¥‡à¤—à¤¾à¥¤

cidr_netmask=21 à¤‡à¤¸à¥à¤¤à¥‡à¤®à¤¾à¤² à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¯à¤¹à¥€ à¤ªà¥ˆà¤•à¥‡à¤œ à¤šà¤¾à¤¹à¤¿à¤à¥¤


--------------------------------------------------------------------------------------------


Step-by-step à¤•à¥à¤¯à¤¾ à¤šà¥‡à¤• à¤•à¤°à¥‡à¤‚ à¤¤à¤¾à¤•à¤¿ VirtualIP resource à¤ à¥€à¤• à¤¸à¥‡ start à¤¹à¥‹ à¤œà¤¾à¤:
1. Resource agent à¤«à¤¼à¤¾à¤‡à¤² à¤®à¥Œà¤œà¥‚à¤¦ à¤¹à¥ˆ à¤¯à¤¾ à¤¨à¤¹à¥€à¤‚
ls /usr/lib/ocf/resource.d/heartbeat/ | grep IPaddr2


à¤…à¤—à¤° IPaddr2 à¤¦à¤¿à¤–à¥‡, à¤¤à¥‹ agent à¤®à¥Œà¤œà¥‚à¤¦ à¤¹à¥ˆà¥¤

2. Resource configuration à¤¸à¤¹à¥€ à¤¹à¥ˆ à¤¯à¤¾ à¤¨à¤¹à¥€à¤‚
pcs resource config VirtualIP


à¤¯à¤¹à¤¾à¤ ip=, cidr_netmask=, nic= à¤¸à¤¹à¥€ à¤¸à¥‡ configured à¤¹à¥‹à¤‚à¥¤

3. Node network interface à¤ à¥€à¤• à¤¸à¥‡ à¤šà¤² à¤°à¤¹à¤¾ à¤¹à¥ˆ
ip -o link show | grep ens192


interface ens192 UP à¤”à¤° RUNNING à¤¹à¥‹à¥¤

4. Cluster status à¤šà¥‡à¤• à¤•à¤°à¥‡à¤‚
pcs status --full


à¤¯à¤¹à¤¾à¤ Resource status à¤¦à¥‡à¤–à¥‡à¤‚ â€” VirtualIP resource Started à¤¯à¤¾ Stopped à¤²à¤¿à¤–à¤¾ à¤¹à¥‹à¤—à¤¾à¥¤

5. Resource à¤•à¥‹ start à¤•à¤°à¥‡à¤‚ (à¤…à¤—à¤° stopped à¤¹à¥ˆ)
pcs resource start VirtualIP

6. Resource status à¤«à¤¿à¤° à¤¸à¥‡ à¤¦à¥‡à¤–à¥‡à¤‚
pcs resource status VirtualIP


à¤¯à¤¹à¤¾à¤ Started à¤¦à¤¿à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤

7. Logs à¤®à¥‡à¤‚ error à¤¦à¥‡à¤–à¥‡à¤‚ à¤…à¤—à¤° start à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹ à¤°à¤¹à¤¾
journalctl -u pacemaker -n 50


à¤¯à¤¾

grep -i VirtualIP /var/log/pacemaker/pacemaker.log

8. Network interface à¤ªà¤° IP check à¤•à¤°à¥‡à¤‚

Resource start à¤¹à¥‹à¤¨à¥‡ à¤ªà¤° VirtualIP à¤•à¥‹ à¤‰à¤¸ interface à¤ªà¤° à¤¦à¥‡à¤– à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚:

ip a show dev ens192 | grep 10.191.145.144


à¤…à¤—à¤° IP à¤¦à¤¿à¤–à¤¾à¤ˆ à¤¦à¥‡ à¤¤à¥‹ resource à¤ à¥€à¤• à¤¸à¥‡ attach à¤¹à¥‹ à¤—à¤¯à¤¾à¥¤

Troubleshooting tips

cidr_netmask à¤—à¤²à¤¤ à¤¹à¥‹ à¤¤à¥‹ error à¤†à¤à¤—à¤¾à¥¤ RHEL 9.6 à¤®à¥‡à¤‚ cidr_netmask=21 à¤¸à¤¹à¥€ à¤¹à¥ˆà¥¤

Network interface à¤¨à¤¾à¤® (e.g. ens192) à¤¸à¤¹à¥€ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤

Firewall à¤¯à¤¾ SELinux blocking à¤¨ à¤•à¤°à¥‡à¥¤

pcs resource cleanup VirtualIP à¤¸à¥‡ resource à¤•à¥€ failure history reset à¤•à¤°à¥‡à¤‚à¥¤

Node quorum à¤¸à¤¹à¥€ à¤¹à¥‹ (pcs status à¤®à¥‡à¤‚ à¤¦à¥‡à¤–à¥‡à¤‚)à¥¤

à¤…à¤—à¤° resource à¤¬à¤¾à¤°-à¤¬à¤¾à¤° fail à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ à¤¤à¥‹ logs à¤”à¤° error messages à¤•à¥‹ à¤§à¥à¤¯à¤¾à¤¨ à¤¸à¥‡ à¤¦à¥‡à¤–à¥‡à¤‚à¥¤

à¤…à¤—à¤° à¤†à¤ª à¤šà¤¾à¤¹à¥‡à¤‚ à¤¤à¥‹ à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤à¤• checklist à¤¯à¤¾ debug commands à¤•à¤¾ à¤›à¥‹à¤Ÿà¤¾ script à¤­à¥€ à¤¬à¤¨à¤¾ à¤¦à¥‡à¤¤à¤¾ à¤¹à¥‚à¤à¥¤

à¤¬à¤¤à¤¾à¤‡à¤!

You said:
ip a show dev ens192 | grep 10.191.145.144   yahi ip dikhna chahiye ya node ka 
ChatGPT said:

ip a show dev ens192 | grep 10.191.145.144 à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¥‹ à¤µà¤¹à¥€ Virtual IP (à¤œà¥‹ Pacemaker resource à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¥‡à¤Ÿ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆ) à¤¦à¤¿à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤, à¤¯à¤¾à¤¨à¥€ à¤†à¤ªà¤•à¤¾ 10.191.145.144 IPà¥¤

à¤®à¤¤à¤²à¤¬:

à¤¯à¤¹ IP node à¤•à¤¾ à¤–à¥à¤¦ à¤•à¤¾ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹à¤¤à¤¾, à¤¬à¤²à¥à¤•à¤¿ à¤œà¥‹ Pacemaker cluster à¤®à¥‡à¤‚ virtual IP resource à¤•à¥‡ à¤¤à¥Œà¤° à¤ªà¤° à¤šà¤² à¤°à¤¹à¤¾ à¤¹à¥ˆ, à¤µà¥‹ à¤¦à¤¿à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤

à¤…à¤—à¤° Virtual IP resource active à¤¹à¥ˆ à¤”à¤° node à¤ªà¤° bind à¤¹à¥‹ à¤šà¥à¤•à¤¾ à¤¹à¥ˆ à¤¤à¥‹ à¤¯à¥‡ IP interface à¤ªà¤° à¤¦à¤¿à¤–à¥‡à¤—à¤¾à¥¤

à¤‰à¤¦à¤¾à¤¹à¤°à¤£:

à¤…à¤—à¤° Virtual IP resource started à¤¹à¥ˆ à¤”à¤° node à¤œà¤¿à¤¸à¤ªà¤° à¤šà¤² à¤°à¤¹à¤¾ à¤¹à¥ˆ à¤µà¥‹ cmpcprmq90 à¤¹à¥ˆ, à¤¤à¥‹ à¤‰à¤¸ node à¤ªà¤° ip a show dev ens192 à¤®à¥‡à¤‚ 10.191.145.144 à¤¦à¤¿à¤–à¥‡à¤—à¤¾à¥¤

à¤¦à¥‚à¤¸à¤°à¥€ node à¤ªà¤° à¤µà¥‹ IP à¤¨à¤¹à¥€à¤‚ à¤¦à¤¿à¤–à¥‡à¤—à¤¾ à¤œà¤¬ à¤¤à¤• à¤•à¤¿ resource à¤‰à¤¸ node à¤ªà¤° move à¤¨ à¤¹à¥‹à¥¤

à¤…à¤—à¤° IP à¤¨à¤¹à¥€à¤‚ à¤¦à¤¿à¤– à¤°à¤¹à¤¾:

Resource start à¤¨à¤¹à¥€à¤‚ à¤¹à¥à¤† à¤¯à¤¾ fail à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆà¥¤

Network interface à¤¨à¤¾à¤® à¤—à¤²à¤¤ à¤¹à¥‹ à¤¸à¤•à¤¤à¤¾ à¤¹à¥ˆà¥¤

Configuration à¤®à¥‡à¤‚ à¤•à¥‹à¤ˆ à¤—à¤²à¤¤à¥€ à¤¹à¥‹ à¤¸à¤•à¤¤à¥€ à¤¹à¥ˆà¥¤

à¤¸à¤‚à¤•à¥à¤·à¥‡à¤ª:

Virtual IP à¤œà¥‹ à¤†à¤ªà¤¨à¥‡ configure à¤•à¤¿à¤¯à¤¾ à¤¹à¥ˆ, à¤µà¥‹ à¤œà¤¿à¤¸ node à¤ªà¤° active à¤¹à¥‹à¤—à¤¾, à¤‰à¤¸à¥€ node à¤ªà¤° à¤‰à¤¸à¤•à¤¾ IP interface à¤ªà¤° à¤¦à¤¿à¤–à¤¾à¤ˆ à¤¦à¥‡à¤—à¤¾à¥¤
à¤†à¤ªà¤•à¥‹ à¤‰à¤¸ node à¤ªà¤° à¤•à¤®à¤¾à¤‚à¤¡ à¤šà¤²à¤¾à¤•à¤° à¤¦à¥‡à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤ à¤œà¤¹à¤¾à¤ resource active à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤





Pacemaker, Corosync, à¤”à¤° STONITH à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥à¤› specific ports à¤šà¤¾à¤¹à¤¿à¤ à¤¹à¥‹à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤
Ports à¤œà¥ˆà¤¸à¥‡:

UDP 5404, 5405 (corosync)

TCP 2224 (pacemaker)

à¤”à¤° à¤†à¤ªà¤•à¥‡ fencing à¤•à¥‡ à¤²à¤¿à¤ à¤œà¥‹ à¤­à¥€ ports/URLs à¤¹à¥ˆà¤‚

à¤…à¤—à¤° firewall on à¤¹à¥ˆ à¤¤à¥‹ open à¤•à¤°à¥‡à¤‚:

firewall-cmd --list-all


à¤¯à¤¾

firewall-cmd --permanent --add-port=5404/udp
firewall-cmd --permanent --add-port=5405/udp
firewall-cmd --permanent --add-port=2224/tcp
firewall-cmd --reload





1. à¤œà¤°à¥‚à¤°à¥€ Ports à¤œà¥‹ Cluster (Pacemaker + Corosync) à¤•à¥‡ à¤²à¤¿à¤ à¤–à¥à¤²à¤¨à¥‡ à¤šà¤¾à¤¹à¤¿à¤:
Service	Protocol	Port(s)	Description
Corosync	UDP	5404, 5405	Cluster communication
Pacemaker	TCP	2224	Cluster management (pcs daemon)
STONITH	TCP/UDP	Depends on fencing device	Fencing device specific
SSH	TCP	22	Remote management / fencing


SELinux à¤•à¥‡ à¤•à¤¾à¤°à¤£ ports block à¤¹à¥‹ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚ à¤¯à¤¾ à¤¨à¤¹à¥€à¤‚, à¤¯à¥‡ à¤­à¥€ à¤šà¥‡à¤• à¤•à¤°à¥‡à¤‚:
sudo getsebool -a | grep pacemaker


6. TCP/UDP Ports OS à¤²à¥‡à¤µà¤² à¤ªà¤° à¤¸à¥à¤¨ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚ à¤¯à¤¾ à¤¨à¤¹à¥€à¤‚:
sudo ss -tunlp | grep -E '5404|5405|2224'





The command:

sudo getsebool -a | grep pacemaker


will display SELinux boolean settings related to Pacemaker on your system.

Example output might look like this:
pacemaker_manage_all_files --> off
pacemaker_use_fenced --> off
pacemaker_use_stonith --> on

Explanation of fields:

Each line shows a SELinux boolean related to Pacemaker.

The value (on or off) indicates whether that particular permission or behavior is enabled (on) or disabled (off).

For example:

pacemaker_use_stonith --> on means Pacemaker is allowed to use STONITH fencing.

pacemaker_manage_all_files --> off means it does not have permission to manage all files.

If you get no output from the command, it means there are no SELinux booleans explicitly related to Pacemaker on your system.

Would you like me to help you interpret the actual output if you run it






